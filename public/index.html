<!DOCTYPE html>
<html lang="en">

<head>
  <title>Safe Eats</title>
  <link rel="stylesheet" type="text/css" href="styles.css"> 
</head>
<body>
  <div class="container">
    <div class="wrapper">
      <div class="header">Safe Eats Test</div>
      <div class="dropdown">
        <button onclick="myFunction()" class="dropbtn">Dropdown</button>
        <div id="myDropdown" class="dropdown-content">
          <input type="text" placeholder="Search.." id="myInput" onkeyup="filterFunction()">
          <a href="#after_school">After School Supper Program</a>
          <a href="#b&b">B & B</a>
          <a href="#bakery">Bakery</a>
          <a href="#bakery_catering">Bakery/Catering</a>
          <a href="#banquet">Banquet Hall/Ballroom</a>
          <a href="#bar">Bar/Tavern/Lounge</a>
          <a href="#cafeteria">Cafeteria</a>
          <a href="#carry_out">Carry-out</a>
          <a href="#casino">Casino</a>
          <a href="#catering_only">Catering Only</a>
          <a href="#church">Church/Temple/Mosque</a>
          <a href="#coffee">Coffee Shop</a>
          <a href="#college">College/University</a>
          <a href="#convenience">Convenience Store</a>
          <a href="#deli">Deli</a>
          <a href="#diner">Diner</a>
          <a href="#dollar_store">Dollar Store</a>
          <a href="#donut">Donut</a>
          <a href="#excluded">Excluded</a>
          <a href="#farmers_market">Farmer's Market</a>
          <a href="#fast_food">Fast Food</a>
          <a href="#fire_hall">Fire/Community Hall</a>
          <a href="#full_service">Full Service</a>
          <a href="#full_serv_catering">Full Service/Catering</a>
          <a href="#gas_station">Gast Station Store</a>
          <a href="#grocery">Grocery Store</a>
          <a href="#group_home">Group Home</a>
          <a href="#health_care">Health Care Facility</a>
          <a href="#hotel">Hotel</a>
          <a href="#ice_cream">Ice Cream</a>
          <a href="#institution">Institution</a>
          <a href="#limited_serv">Limited Service</a>
          <a href="#meat_market">Meat/Poultry Market</a>
          <a href="#membership_warehouse">Membership Warehouse</a>
          <a href="#micro_market">Micro Market</a>
          <a href="#multiple_faciliites">Multiple Facilities</a>
          <a href="#night_club">Night Club</a>
          <a href="#pizza">Pizza</a>
          <a href="#pre-packaged">Pre-Packaged Only</a>
          <a href="#private_club">Private Club</a>
          <a href="#private_school">Private School</a>
          <a href="#public_school">Public School</a>
          <a href="#restaurant">Restaurant</a>
          <a href="#school">School</a>
          <a href="#seafood">Seafood</a>
          <a href="#senior_nutrition">Senior Nutrition Program</a>
          <a href="#snack_bar">Snack Bar/Concession Stand</a>
          <a href="#amusement_park">Stadium/Amusement Park</a>
        </div>
      </div>

      <button class="button" onclick="loadData()">Search</button>
      <button class="button" onclick="test(total)">Try Me</button>
      <div id="teststuff"></div>
      <div id="content"></div>
      <div class="footer"></div>
    </div>
  </div>
  <script>

    //add another then to the chain & use it to access all functions
    //just call the function & pass all of the functions along to the next steps
    //makes code more legible to other people & can split out functions and have people look over them more specifically
    //jquery is global & not compatible with REACT; would have to be included at the top of the page in the head 
    //will have to check if jquery document has been fully loaded
    //css animations? jquery is a good learning library but there are drawbacks 
    let total = new Array();
    let names = new Array();
    let categories = new Array();

    function loadData() {
          console.log("fetch"); // confirm code is running on click
          fetch("/api")
            .then(res => res.json())
            .then(res => {
              console.log(res); // logging step to check what we got
              return res;
            })
            .then(res => res.data.map(c => c))
            .then(res => {
              let new_list = document.createElement("ul");
              let old_list = document.querySelector("#content");
              old_list.innerHTML = '';
              new_list.innerHTML = '';
              for(let x = 0; x < res.length; x++){
                let new_item = document.createElement("li");
                let store_name = res[x].name;
                let store_category = res[x].category;
                store_name = document.createTextNode(store_name);
                store_category = document.createTextNode(store_category);
                new_item.append(store_category);
                new_item.append(" ");
                new_item.append(store_name);
                new_list.append(new_item);
                //console.log(res[x]);
                names.push(res[x].name);
                categories.push(res[x].category);

          }
          old_list.append(new_list);
          //let total = new Array();
          total.push(res);
          total.push(names);
          total.push(categories);
          //return res;
          //return names;
          //return categories;
          console.log(total.length);
          console.log(total[1].length);
          return total; 
        }//package 
            );
        }
    function myFunction(){
        document.getElementById("myDropdown").classList.toggle("show");
}
    function filterFunction() {
        var input, filter, ul, li, a, i;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        div = document.getElementById("myDropdown");
        a = div.getElementsByTagName("a");
        for (i = 0; i < a.length; i++) {
            txtValue = a[i].textContent || a[i].innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
            a[i].style.display = "";
            } else {
             a[i].style.display = "none";
            }
        }
 }

 function test(total){
   console.log(total);
   console.log(categories.length);
   let search_results = document.createElement('ol');
   let old_test = document.querySelector("#teststuff");
   old_test.innerHTML = "";
   for(let x = 0; x < categories.length; x++){
     if(categories[x] == "Fast Food"){
      let search_item = document.createElement('li'); 
      search_item.appendChild(document.createTextNode(names[x]));
      search_results.appendChild(search_item);
     }
   }
   console.log(search_results);
   old_test.append(search_results);
 }

  </script>
</body>

</html> 

<!-- //lab 5; overwrite div with something else
//filter full list & build links then inject that into the page 
//.innerhtml should be used 
//pass filtered data into next step; do return & then
//next step do an injection 
//instead of hardcoding filter, put them into arrays with id & string shown on screen 
//first is id, next is what you want people to say
//put in array file & store in json as static file 
//best way to store data is put it into separate json file 
//inport data & inject links 
//make a separate injection function to load on different lists whenever you need
//server.js should serve a public directory whch will be a build directory
//source code will be moved into build folder 
//express.static is public folder and that's where the finished code is; this would be build for us 
//anonymous snitch line about conditions in the kitchen <-- considerations for the final presentation 
//push the project further if you're not going to program a lot 
 -->